/*
ChocolateChip-UI
ChUI.js
Copyright 2015 Sourcebits www.sourcebits.com
License: MIT
Version: 3.8.10
*/
window.CHUIJSLIB,window.jQuery?window.CHUIJSLIB=window.jQuery:window.$chocolatechipjs&&(window.CHUIJSLIB=window.$chocolatechipjs),function(e){function t(e){return"tagName"in e?e:e.parentNode}function i(e,t,i,s){return Math.abs(e-t)>=Math.abs(i-s)?e-t>0?"left":"right":i-s>0?"up":"down"}function s(){if(p=null,c.last)try{c&&c.el&&(c.el.trigger("longtap"),c={})}catch(e){}}function n(){p&&clearTimeout(p),p=null}function a(){r&&clearTimeout(r),d&&clearTimeout(d),l&&clearTimeout(l),p&&clearTimeout(p),r=d=l=p=null,c={}}function o(t){function i(e){return/m/.test(e)?parseFloat(e):/s/.test(e)?100*parseFloat(e):void 0}var s,n;"transition"in document.body.style?s="transition-duration":"-webkit-transition"in document.body.style&&(s="-webkit-transition-duration"),n=i(e("article").eq(0).css(s)),setTimeout(function(){e(t).trigger({type:"navigationend"})},n)}e.extend({UuidBit:1,Uuid:function(){return this.UuidBit++,Date.now().toString(36)+this.UuidBit},concat:function(e){return e instanceof Array?e.join(""):[].slice.apply(arguments).join("")},forEach:function(e,t,i){function s(e){var t=e.length,i=typeof e;return"function"===i||e===window?!1:1===e.nodeType&&t?!0:"array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e}var n,a=0,o=e.length,r=s(e);if(i){if(r)for(;o>a&&(n=t.apply(e[a],i),n!==!1);a++);else for(a in e)if(n=t.apply(e[a],i),n===!1)break}else if(r)for(;o>a&&(n=t.call(e[a],e[a],a),n!==!1);a++);else for(a in e)if(n=t.call(e[a],e[a],a),n===!1)break}}),e.fn.extend({forEach:function(t,i){var s=this;return e.forEach(s,t,i)},iz:function(t){if(window.jQuery){var i=e();return this.forEach(function(s){e(s).is(t)&&i.push(s)}),i}return window.$chocolatechipjs?this.is(t):void 0},unique:function(){var e=[],t=this.sort();return t.forEach(function(t,i){-1===e.indexOf(t)&&e.push(t)}),e.length?e:[]},iznt:function(e){return window.jQuery?this.not(e):window.$chocolatechipjs?this.isnt(e):void 0},haz:function(e){return this.has(e)},haznt:function(t){if(window.jQuery){var i=e();return this.forEach(function(s){e(s).has(t)[0]||i.push(s)}),i}return window.$chocolatechipjs?this.hasnt(t):void 0},hazClass:function(t){if(window.jQuery){var i=e();return this.forEach(function(s){e(s).hasClass(t)&&i.push(s)}),i}return window.$chocolatechipjs?this.hasClass(t):void 0},hazntClass:function(t){if(window.jQuery){var i=e();return this.forEach(function(s){e(s).hasClass(t)||i.push(s)}),i}if(window.$chocolatechipjs){var i=[];return this.forEach(function(e){e.classList.contains(t)&&i.push(e)}),i}},hazAttr:function(t){if(window.jQuery){var i=e();return this.forEach(function(s){e(s).attr(t)&&i.push(s)}),i}if(window.$chocolatechipjs){var i=[];return i}},hazntAttr:function(t){if(window.jQuery){var i=e();return this.forEach(function(s){e(s).attr(t)||i.push(s)}),i}if(window.$chocolatechipjs){var i=[];return ctx.hasAttribute(t)||i.push(ctx),i}}}),e.extend({eventStart:null,eventEnd:null,eventMove:null,eventCancel:null,gestureLength:30}),e(function(){window.navigator.pointerEnabled?(e.eventStart="pointerdown",e.eventEnd="pointerup",e.eventMove="pointermove",e.eventCancel="pointercancel"):window.navigator.msPointerEnabled?(e.eventStart="MSPointerDown",e.eventEnd="MSPointerUp",e.eventMove="MSPointerMove",e.eventCancel="MSPointerCancel"):"ontouchstart"in window&&/mobile/gim.test(navigator.userAgent)?(e.eventStart="touchstart",e.eventEnd="touchend",e.eventMove="touchmove",e.eventCancel="touchcancel"):(e.eventStart="mousedown",e.eventEnd="click",e.eventMove="mousemove",e.eventCancel="mouseout")}),e.extend({isMobile:/mobile/gim.test(navigator.userAgent),isTrident:/trident/gim.test(navigator.userAgent),isIEEdge:/edge/gim.test(navigator.userAgent),isWinPhone:(/trident/gim.test(navigator.userAgent)||/edge/gim.test(navigator.userAgent))&&/mobile/gim.test(navigator.userAgent),isiPhone:!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/iphone/gim.test(navigator.userAgent),isiPad:!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/ipad/gim.test(navigator.userAgent),isiPod:!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/ipod/gim.test(navigator.userAgent),isiOS:!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/ip(hone|od|ad)/gim.test(navigator.userAgent),isAndroid:!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/android/gim.test(navigator.userAgent)&&!/trident/gim.test(navigator.userAgent),isWebOS:/webos/gim.test(navigator.userAgent),isBlackberry:/blackberry/gim.test(navigator.userAgent),isTouchEnabled:!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&"createTouch"in document,isOnline:navigator.onLine,isStandalone:navigator.standalone,isiOS6:!/trident/gim.test(navigator.userAgent)&&!e.isEdge&&/OS 6/gim.test(navigator.userAgent),isiOS7:!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/OS 7/gim.test(navigator.userAgent),isiOS8:!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/OS 8/gim.test(navigator.userAgent),isiOS9:!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/OS 9/gim.test(navigator.userAgent),isWin:/edge/gim.test(navigator.userAgent)||/trident/gim.test(navigator.userAgent),isIE10:/msie 10/gim.test(navigator.userAgent),isIE11:/windows nt/gim.test(navigator.userAgent)&&/trident/gim.test(navigator.userAgent),isWebkit:!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/webkit/gim.test(navigator.userAgent),isDesktop:!/mobile/gim.test(navigator.userAgent),isSafari:!/edge/gim.test(navigator.userAgent)&&!/Chrome/gim.test(navigator.userAgent)&&/Safari/gim.test(navigator.userAgent)&&!/android/gim.test(navigator.userAgent),isChrome:!(/trident/gim.test(navigator.userAgent)||/edge/gim.test(navigator.userAgent)||!/Chrome/gim.test(navigator.userAgent)||(/samsung/gim.test(navigator.userAgent)||/Galaxy Nexus/gim.test(navigator.userAgent)||/HTC/gim.test(navigator.userAgent)||/LG/gim.test(navigator.userAgent))&&!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/android/i.test(navigator.userAgent)&&/webkit/i.test(navigator.userAgent)),isNativeAndroid:(/samsung/gim.test(navigator.userAgent)||/Galaxy Nexus/gim.test(navigator.userAgent)||/HTC/gim.test(navigator.userAgent)||/LG/gim.test(navigator.userAgent))&&!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/android/i.test(navigator.userAgent)&&/webkit/i.test(navigator.userAgent),isWideScreen:window.innerWidth>=960&&(90===window.orientation||-90===window.orentation),isWideScreenPortrait:window.innerWidth>=960&&(90!==window.orientation||-90!==window.orientation)}),e.extend({browserVersion:function(){var e,t=navigator.appName,i=navigator.userAgent,s=i.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);return s&&null!==(e=i.match(/version\/([\.\d]+)/i))&&(s[2]=e[1]),s=s?[s[1],s[2]]:[t,navigator.appVersion,"-?"],s[1]}}),e(function(){e.body=e("body"),/android/gim.test(navigator.userAgent)&&/webkit/gim.test(navigator.userAgent)&&!/Chrome/gim.test(navigator.userAgent)&&e.body.addClass("isNativeAndroidBrowser"),e.isWin?e.body.addClass("isWindows"):e.isiOS?e.body.addClass("isiOS"):e.isAndroid&&e.body.addClass("isAndroid"),e.isSafari&&6===parseInt(e.browserVersion(),10)&&e.body.addClass("isSafari6"),e.isNativeAndroid&&e.body.addClass("isNativeAndroidBrowser")});var r,l,d,c={},u=750,h=150;e.gestureLength=50,e.isAndroid&&(h=200);var p;e(function(){var o,v,g=e(document.body),f=!1;g.on(e.eventStart,function(i){if(o=Date.now(),v=o-(c.last||o),i.originalEvent&&(i=i.originalEvent),window.navigator.pointerEnabled||window.navigator.msPointerEnabled){if(window&&window.jQuery&&e===window.jQuery){if(i.originalEvent&&!i.originalEvent.isPrimary)return}else if(!i.isPrimary)return;i=i.originalEvent?i.originalEvent:i,g.on("MSHoldVisual",function(e){e.preventDefault()}),c.el=e(t(i.target)),r&&clearTimeout(r),c.x1=i.pageX,c.y1=i.pageY,f=!1}else"mousedown"===e.eventStart?(c.el=e(t(i.target)),r&&clearTimeout(r),c.x1=i.pageX,c.y1=i.pageY,f=!1):1===i.touches.length&&(c.el=e(t(i.touches[0].target)),r&&clearTimeout(r),c.x1=i.touches[0].pageX,c.y1=i.touches[0].pageY,f=2===i.targetTouches.length?!0:!1);v>0&&250>=v&&(c.isDoubleTap=!0),c.last=o,p=setTimeout(s,u)}),g.on(e.eventMove,function(t){if(t.originalEvent&&(t=t.originalEvent),window.navigator.msPointerEnabled){if(window&&window.jQuery&&e===window.jQuery){if(t.originalEvent&&!t.originalEvent.isPrimary)return}else if(!t.isPrimary)return;t=t.originalEvent?t.originalEvent:t,n(),c.x2=t.pageX,c.y2=t.pageY}else n(),"mousemove"===e.eventMove?(c.x2=t.pageX,c.y2=t.pageY):1===t.touches.length&&(c.x2=t.touches[0].pageX,c.y2=t.touches[0].pageY)}),g.on(e.eventEnd,function(t){if(window.navigator.pointerEnabled||window.navigator.msPointerEnabled)if(window&&window.jQuery&&e===window.jQuery){if(t.originalEvent&&!t.originalEvent.isPrimary)return}else if(!t.isPrimary)return;n(),c.el&&(c.x2&&Math.abs(c.x1-c.x2)>e.gestureLength||c.y2&&Math.abs(c.y1-c.y2)>e.gestureLength?l=setTimeout(function(){c&&c.el&&(c.el.trigger("swipe"),c.el.trigger("swipe"+i(c.x1,c.x2,c.y1,c.y2)),c={})},0):"last"in c&&(d=setTimeout(function(){c&&c.el&&c.el.trigger("tap"),c&&c.isDoubleTap?c&&c.el&&(c.el.trigger("doubletap"),c={}):r=setTimeout(function(){return r=null,c&&c.el?(c.el.trigger("singletap"),c={},!1):void 0},h)},0)))}),g.on("touchcancel",a)}),["swipe","swipeleft","swiperight","swipeup","swipedown","doubletap","tap","singletap","longtap"].forEach(function(t){e.fn.extend({method:function(e){return this.on(t,e)}})}),e.extend({UIDesktopCompat:function(){e.isDesktop&&e.isSafari?e("body").addClass("isiOS").addClass("isDesktopSafari isDesktop"):e.isDesktop&&e.isChrome&&e("body").addClass("isAndroid").addClass("isDesktopChrome isDesktop")}}),e(function(){e.UIDesktopCompat()}),e(function(){e.body=e("body"),e.body[0].classList.contains("splitlayout")||e("body").prepend("<nav id='global-nav'></nav>"),e.body[0].classList.contains("splitlayout")&&window.innerWidth<768&&e("meta[name=viewport]").attr("content","width=device-width, initial-scale=0.45, maximum-scale=2, user-scalable=yes"),e("h1").each(function(e,t){t.nextElementSibling&&"A"===t.nextElementSibling.nodeName&&t.classList.add("buttonOnRight")}),e(".toolbar").prev("article").addClass("has-toolbar"),e.isiOS&&e.isStandalone&&e.body[0].classList.add("isStandalone")}),e.extend({UIHideNavBar:function(){e("nav").hide(),e.body.addClass("hide-navbars")},UIShowNavBar:function(){e("nav").show(),e.body.removeClass("hide-navbars")}}),e.extend({subscriptions:{},subscribe:function(t,i){e.subscriptions[t]||(e.subscriptions[t]=[]);var s=e.Uuid();return e.subscriptions[t].push({token:s,callback:i}),s},unsubscribe:function(t){setTimeout(function(){for(var i in e.subscriptions)if(e.subscriptions[i])for(var s=0,n=e.subscriptions[i].length;n>s;s++)if(e.subscriptions[i][s].token===t)return e.subscriptions[i].splice(s,1),t;return!1})},publish:function(t,i){return e.subscriptions[t]?(setTimeout(function(){for(var s=e.subscriptions[t]?e.subscriptions[t].length:0;s--;)e.subscriptions[t][s].callback(t,i);return!0}),!0):!1}}),e.extend({UITrackHashNavigation:function(t,i){t=t||!0,e.UISetHashOnUrl(e.UINavigationHistory[e.UINavigationHistory.length-1],i)},UISetHashOnUrl:function(t,i){i=i||"#/";var s;s=/^#/.test(t)?i+t.split("#")[1]:i+t,e.isAndroid?(/#/.test(t)&&(t=t.split("#")[1]),/\//.test(t)&&(t=t.split("/")[1]),window.location.hash="#/"+t):window.history.replaceState("Object","Title",s)},UIGoBackToArticle:function(t){var i,s,n=e.UINavigationHistory.indexOf(t),a=e("article.current"),r=e(t);0===e.UINavigationHistory.length&&(r=e("article:first-of-type"),e.UINavigationHistory.push("#"+r[0].id));var l;l=e.UINavigationHistory.length>1?e.UINavigationHistory.splice(n+1):e("article.previous"),e.publish("chui/navigateBack/leave",a[0].id),e.publish("chui/navigateBack/enter",r[0].id),a[0].scrollTop=0,r[0].scrollTop=0,l.length&&e.forEach(l,function(t){e(t).removeClass("previous").addClass("next"),e(t).prev().removeClass("previous").addClass("next")}),i=a.next().hazClass("toolbar"),s=r.next().hazClass("toolbar"),r.removeClass("previous next").addClass("current"),r.prev().removeClass("previous next").addClass("current"),s.removeClass("previous next").addClass("current"),a.removeClass("current").addClass("next"),a.prev().removeClass("current").addClass("next"),i.removeClass("current").addClass("next"),e(".toolbar.previous").removeClass("previous").addClass("next"),e.UISetHashOnUrl(e.UINavigationHistory[e.UINavigationHistory.length-1]),o(r)},UIGoBack:function(){var t,i,s=e.UINavigationHistory.length,n=e("article.current"),a=e(e.UINavigationHistory[s-2]);0===s&&(a=e("article:first-of-type"),e.UINavigationHistory.push("#"+a[0].id)),e.publish("chui/navigateBack/leave",n[0].id),e.publish("chui/navigateBack/enter",a[0].id),n[0].scrollTop=0,a[0].scrollTop=0,t=n.next().hazClass("toolbar"),i=a.next().hazClass("toolbar"),a.removeClass("previous").addClass("current"),a.prev().removeClass("previous").addClass("current"),i.removeClass("previous").addClass("current"),n.removeClass("current").addClass("next"),n.prev().removeClass("current").addClass("next"),t.removeClass("current").addClass("next"),e.UISetHashOnUrl(e.UINavigationHistory[s-2]),1!==e.UINavigationHistory.length&&(e.UINavigationHistory.pop(),o(a))},isNavigating:!1,UIGoToArticle:function(t){if(!e.isNavigating){e.isNavigating=!0;var i=e("article.current"),s=i.prev();t=e(t);var n,a,r="#"+t[0].id,l=t.prev(),d="next previous";e.publish("chui/navigate/leave",i[0].id),e.UINavigationHistory.push(r),e.publish("chui/navigate/enter",t[0].id),i[0].scrollTop=0,t[0].scrollTop=0,n=i.next().hazClass("toolbar"),a=t.next().hazClass("toolbar"),i.removeClass("current").addClass("previous"),s.removeClass("current").addClass("previous"),n.removeClass("current").addClass("previous"),t.removeClass(d).addClass("current"),l.removeClass(d).addClass("current"),a.removeClass(d).addClass("current"),e.UISetHashOnUrl(t[0].id),setTimeout(function(){e.isNavigating=!1},500),o(t)}}}),e(function(){e.extend({UINavigationHistory:["#"+e("article").eq(0).attr("id")]}),e("nav:not(#global-nav)").forEach(function(t,i){e("body")[0].classList.contains("splitlayout")||t.classList.add(0===i?"current":"next")}),e("article").forEach(function(t,i){e("body")[0].classList.contains("splitlayout")||e("body")[0].classList.contains("slide-out-app")||t.classList.add(0===i?"current":"next")}),e("body").on("singletap",".back",function(){this.classList.contains("back")&&e.UIGoBack()}),e("body").on("singletap doubletap","li",function(){var t=e(this);if(!e.isNavigating&&this.hasAttribute("data-goto")&&this.getAttribute("data-goto")&&document.getElementById(this.getAttribute("data-goto"))&&!e(this).parent()[0].classList.contains("deletable")){t.addClass("selected");var i="#"+this.getAttribute("data-goto");e(i).addClass("navigable"),setTimeout(function(){t.removeClass("selected")},1e3);var s=e(i);e.isAndroid||e.isChrome?setTimeout(function(){e.UIGoToArticle(s)},200):e.UIGoToArticle(s)}}),e("li[data-goto]").forEach(function(t){e(t).closest("article").addClass("navigable");var i="#"+t.getAttribute("data-goto");e(i).addClass("navigable")}),e("article").eq(1)[0]&&e.UISetHashOnUrl(e("article").eq(0)[0].id),e("nav").on(e.eventStart,function(e){e.preventDefault()})}),e(function(){e("body").on("singletap","button",function(){var t=e(this);t.parent(".segmented")[0]||t.parent(".tabbar")[0]||this.classList.contains("slide-out-button")||this.classList.contains("back")||this.classList.contains("backTo")||(t.addClass("selected"),setTimeout(function(){t.removeClass("selected")},1e3))})}),e.fn.extend({UIBlock:function(t){return t=t?" style='opacity:"+t+"'":" style='opacity: .5;'",e(this).before("<div class='mask'"+t+"></div>"),e("article.current").attr("aria-hidden",!0),this},UIUnblock:function(){return e(".mask").remove(),e("article.current").removeAttr("aria-hidden"),this}}),e.fn.extend({UICenter:function(t){var t=t;if(this[0]){var i=e(this),s=i.parent();t?e(this.css("position",t)):t="absolute"===i.css("position")?"absolute":"relative";var n,a,o,r;"absolute"===t?(n=i[0].clientHeight,a=i[0].clientWidth,o=s[0].clientHeight,r=s[0].clientWidth):(n=parseInt(i.css("height"),10),a=parseInt(i.css("width"),10),o=parseInt(s.css("height"),10),r=parseInt(s.css("width"),10),e(this).css({"margin-left":"auto","margin-right":"auto"}));var l,d;"body"===s[0].nodeName?(l=window.innerHeight/2+window.pageYOffset-n/2+"px",d=window.innerWidth/2-a/2+"px"):(l=o/2-n/2+"px",d=r/2-a/2+"px"),"absolute"!==t&&(d=0),i.css({left:d,top:l})}}}),e.fn.extend({UIBusy:function(t){t=t||{};var i={size:43,color:"#000",position:!1,duration:"2s"};e.extend(i,t);var s,n=this,a=function(){var t={"-webkit-animation-duration":i.duration};return s=e('<span class="busy"></span>'),e(s).css({"background-color":i.color,height:i.size+"px",width:i.size+"px"}),e(s).css(t),e(s).attr("role","progressbar"),i.position&&e(s).addClass(i.position),n.append(s),this},o=function(){i.id=e.Uuid();var s=null,a=i.position?" "+i.position:"";return e.isNativeAndroid?(s='<svg class="busy'+a+'" version="1.1" id="'+i.id+'" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve"><g><path fill="none" stroke="'+i.color+'" stroke-width="10" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M74.2,65c2.7-4.4,4.3-9.5,4.3-15c0-15.7-12.8-28.5-28.5-28.5S21.5,34.3,21.5,50c0,5.5,1.6,10.6,4.3,15"/></g><polyline fill="none" stroke="'+i.color+'" stroke-width="10" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="89.4,56.1 74.3,65 65.4,49.9 "/></svg>',void n.append(s)):(s='<svg id="'+i.id+'" class="busy'+a+'" x="0px" y="0px" viewBox="0 0 100 100"><circle stroke="url(#SVGID_1_)" cx="50" cy="50" r="28.5"/></svg>',n.append(s),n.addClass("hasActivityIndicator"),i.position&&e("#"+i.id).addClass(i.position),t.color&&e("#"+i.id).find("circle").css("stroke",t.color),e("#"+i.id).css({height:i.size+"px",width:i.size+"px"}),e("#"+i.id))},r=function(){return s=e('<progress class="busy"></progress>'),e(s).css({color:i.color}),e(s).attr("role","progressbar"),e(s).addClass("win-ring"),i.position&&e(s).addClass(i.position),n.append(s),this};e.isWin?r(t):e.isAndroid||e.isChrome?o(t):(e.isiOS||e.isSafari)&&a(t)}}),e.extend({UIPopup:function(t){if(t){var i={};i.id=e.Uuid(),i.content=!0,e.extend(i,t);var s,n,a=i.id,o=i.title?"<header><h1>"+i.title+"</h1></header>":"",r=i.message?'<p role="note">'+t.message+"</p>":"",l=t.cancelButton?'<button class="cancel" role="button">'+i.cancelButton+"</button>":"",d=i.continueButton?'<button class="continue" role="button">'+i.continueButton+"</button>":"",c=i.callback||e.noop;n=i.empty?e.concat('<div class="popup closed" role="alertdialog" id="',a,'"><div class="panel"></div></div>'):e.concat('<div class="popup closed','" role="alertdialog" id="',a,'"><div class="panel">',o,r,"</div><footer>",l,d,"</footer>",s,"</div>"),e("body").append(n),c&&d&&e(".popup").find(".continue").on(e.eventStart,function(){var t=e(this);e.isAndroid||e.isChrome?(t.addClass("selected"),setTimeout(function(){t.removeClass("selected"),e(".popup").UIPopupClose(),c.call(c)},300)):(e(".popup").UIPopupClose(),c.call(c))}),e.UICenterPopup(),setTimeout(function(){e("body").find(".popup").addClass("opened"),e("body").find(".popup").removeClass("closed")},200),e("body").find(".popup").UIBlock("0.5");var u=e.eventStart+" singletap "+e.eventEnd;e(".mask").on(u,function(e){e.stopPropagation()})}},UICenterPopup:function(){var t=e(".popup");if(t[0]){var i,s=window.innerHeight/2+window.pageYOffset-t[0].clientHeight/2+"px";i=320===window.innerWidth?"10px":Math.floor((window.innerWidth-318)/2)+"px",t.css(e.isWin?{top:s}:{left:i,top:s})}}}),e.fn.extend({UIPopupClose:function(){(this||this.classList.contains("popup"))&&(e(this).UIUnblock(),e(this).remove())}}),e(function(){e("body").on(e.eventStart,".cancel",function(){var t=e(this);t.closest(".popup")[0]&&(e.isAndroid||e.isChrome?(t.addClass("selected"),setTimeout(function(){t.closest(".popup").UIPopupClose(),t.removeClass("selected")},300)):t.closest(".popup").UIPopupClose())}),e(window).on("resize",function(){e.UICenterPopup()})}),e.extend({UIPopover:function(t){t=t||{};var i={id:e.Uuid(),callback:e.noop,title:""};e.extend(i,t),t&&t.content?i.content=t.content:i.content="";var s="<header><h1>"+i.title+"</h1></header>",n='<div class="popover" id="'+i.id+'">'+s+"<section></section></div>",a="#"+i.id,o=function(t){var i,s,n=e(t).offset(),o=n.left,r=e(a),l=r.offset();i=l.left,s=n.top+e(t)[0].clientHeight,r.css(r.width()+n.left>window.innerWidth?{left:window.innerWidth-r.width()-20+"px",top:s-30+"px"}:{left:o+"px",top:s-30+"px"})};return e(".mask")[0]?(e.UIPopoverClose(),void e("body").UIUnblock()):(e("body").append(n),(e.isAndroid||e.isChrome)&&setTimeout(function(){e(a).addClass("opened")},50),e.isWin&&e(a).addClass("open"),e(a).data("triggerEl",i.trigger),e(a).find("section").append(i.content),i.callback.call(i.callback,i.trigger),o(i.trigger),void e(".popover").UIBlock(".5"))}}),e.extend({UIAlignPopover:function(){var t=e(".popover");if(t.length){var i=t.data("triggerEl"),s=e(i).offset(),n=s.left;t.css(e(t).width()+s.left>window.innerWidth?{left:window.innerWidth-e(t).width()-20+"px"}:{left:n+"px"})}}}),e.extend({UIPopoverClose:function(){e("body").UIUnblock(),e(".popover").css("visibility","hidden"),setTimeout(function(){e(".popover").remove()},10)}}),e(function(){e(window).on("resize",function(){e.UIAlignPopover()});var t=e.eventStart+" singletap "+e.eventEnd;e("body").on(t,".mask",function(t){if(e(".popover")[0])e.UIPopoverClose();else{if(t&&1===t.nodeType)return;t.stopPropogation()}})}),e.fn.extend({UISegmented:function(t){var i={selected:0,callback:e.noop};if(t&&e.extend(i,t),!e(this).hazClass("paging").length){var s=i.callback,n=i.selected;this.find("button").forEach(function(t,i){e(t).attr("role","radio"),e(t).addClass("segment"),i===n&&(t.setAttribute("aria-checked","true"),t.classList.add("selected"))}),this.on("singletap","button",function(t){var i=e(this);this.parentNode.classList.contains("paging")||(i.siblings("button").removeClass("selected"),i.siblings("button").removeAttr("aria-checked"),i.addClass("selected"),i.attr("aria-checked",!0),s.call(this,t))})}}}),e.extend({UICreateSegmented:function(t){var i,s=t&&t.id?t.id:e.Uuid(),n=t&&t.className?t.className:"",a=t&&t.labels?t.labels:[],o=(t&&t.selected?t.selected:0,['<div class="segmented']);return n&&o.push(" "+n),o.push('">'),a.forEach(function(e,t){o.push('<button role="radio" class="segment"'),o.push('"'),o.push(">"),o.push(e),o.push("</button>")}),o.push("</div>"),i=e(o.join("")),i.attr("id",s),i}}),e.fn.extend({UIPanelToggle:function(t,i){var s,n=0;n=this.children().hazClass("selected").index()||0,t instanceof Array?s=t.children("div"):"string"==typeof t&&(s=e(t).children("div")),s.eq(n).siblings().css({display:"none"}),i&&i.apply(this,arguments),this.on(e.eventEnd,"button",function(){s.eq(e(this).index()).css({display:"block"}).siblings().css("display","none")}),this.on("singletap","button",function(){var t=e(this);this.parentNode.classList.contains("paging")||(t.siblings("button").removeClass("selected"),t.siblings("button").removeAttr("aria-checked"),t.addClass("selected"),t.attr("aria-checked",!0))})}}),e.extend({UIPaging:function(){var t=e(".segmented.paging").closest("nav").next();e(".segmented.paging").hazClass("horizontal").length?t.addClass("horizontal"):e(".segmented.paging").hazClass("vertical").length&&t.addClass("vertical"),t.children().eq(0).addClass("current"),t.children().eq(0).siblings().addClass("next");var i=function(){return t.children().length},s=function(s){if(1!==i()){s.next().removeClass("selected"),s.addClass("selected");var n;n=e("section.current"),0===n.index()?(n.removeClass("current"),t.children().eq(i()-1).addClass("current").removeClass("next"),t.children().eq(i()-1).siblings().removeClass("next").addClass("previous")):(n.removeClass("current").addClass("next"),n.prev().removeClass("previous").addClass("current")),setTimeout(function(){s.removeClass("selected")},250)}},n=function(s){if(1!==i()){s.prev().removeClass("selected"),s.addClass("selected");var n;s[0].classList.contains("disabled")||(n=e("section.current"),n.index()===i()-1?(n.removeClass("current"),t.children().eq(0).addClass("current").removeClass("previous"),t.children().eq(0).siblings().removeClass("previous").addClass("next")):(n.removeClass("current").addClass("previous"),n.next().removeClass("next").addClass("current")),setTimeout(function(){s.removeClass("selected")},250))}};e(".segmented.paging").on(e.eventStart,"button:first-of-type",function(){s(e(this))}),e(".segmented.paging").on(e.eventStart,"button:last-of-type",function(){n(e(this))}),e("article.paging.horizontal")[0]&&(e("article.paging").on("swiperight",function(){s(e("button:first-of-type"))}),e("article.paging").on("swipeleft",function(){n(e("button:last-of-type"))})),e("article.paging.vertical")[0]&&(e("article.paging").on("swipeup",function(){s(e("button:first-of-type"))}),e("article.paging").on("swipeudown",function(){n(e("button:last-of-type"))}))}}),e.fn.extend({UIEditList:function(t){var i={editLabel:"Edit",doneLabel:"Done",deleteLabel:"Delete",callback:e.noop,deletable:!0,movable:!0};if(t&&(e.extend(i,t),i.deletable||i.movable)){var s,n,a,o,r,l,d=e.isiOS||e.isSafari?d:"transform",c=i.editLabel,u=(i.doneLabel,i.deleteLabel),h=(i.placement,i.callback,"swiperight"),p="swipeleft",v=e("html").attr("dir");v=v?v.toLowerCase():"","rtl"===v&&(h="swipeleft",p="swiperight"),e.isWin&&(u="");e("li").eq(0)[0].clientHeight;if(i.deletable&&(s=e.concat('<button class="delete"><label>',u,"</label></button>"),a='<span class="deletion-indicator"></span>',e(this).addClass("deletable")),i.movable){var r="<span class='move-up'></span>",l="<span class='move-down'></span>";e(this).addClass("editable")}n=e.concat('<button class="edit">',c,"</button>"),e(this).closest("article").prev().find(".edit")[0]||e(this).closest("article").prev().find(".done")[0]||e(this).closest("article").prev().append(n),o=e(this).closest("article").prev().find(".edit"),e(this).find("li").forEach(function(t){e(t).has(".deletion-indicator").length||(i.deletable&&e(t).prepend(a),i.movable&&(e(t).append(r),e(t).append(l)),i.deletable&&e(t).append(s))});var g=[];e(this).find("li").forEach(function(t,i){0===i?e(t).attr("data-list-position","0"):e(t).attr("data-list-position",i),g.push(i)}),e(this).attr("data-list-items-position",g.join(","));var f=function(t,s,n){e(function(){n.on("singletap",function(){var n=this;if(this.classList.contains("edit"))setTimeout(function(){n.classList.remove("edit"),n.classList.add("done"),e(n).text(i.doneLabel),e(s).addClass("showIndicators")});else if(this.classList.contains("done")){e(s).data("list-edit")&&t.call(t,s),setTimeout(function(){n.classList.remove("done"),n.classList.add("edit"),e(n).text(i.editLabel),e(s).removeClass("showIndicators"),e(s).find("li").removeClass("selected")});var a=[];e(s).find("li").forEach(function(t,i){a.push(e(t).attr("data-list-position"))}),e(s).attr("data-list-items-position",a.join(","))}}),e(s).off("singletap",".deletion-indicator"),e(s).on("singletap",".deletion-indicator",function(){return e(this).parent("li").hazClass("selected").length?void e(this).parent("li").removeClass("selected"):void e(this).parent("li").addClass("selected")}),e(s).on(h,"li",function(){i.deletable&&e(this).removeClass("selected")}),e(s).on(p,"li",function(){i.deletable&&e(this).addClass("selected")}),e(s).on("singletap",".move-up",function(t){var i=e(this).closest("li");if(!(window.$chocolatechipjs&&i.is("li:first-child")[0]||window.jQuery&&i.is("li:first-child"))){e(s).data("list-edit",!0);var i=e(this).closest("li"),n=i.prev(),a=i.clone(),o=n.clone(),r=i[0].offsetHeight;i.css({"-webkit-transform":"translate3d(0,-"+r+"px,0)",transform:"translate3d(0,-"+r+"px,0)"}),n.css({"-webkit-transform":"translate3d(0,"+r+"px,0)",transform:"translate3d(0,"+r+"px,0)"}),setTimeout(function(){window.$chocolatechipjs?(e.replace(o,i),e.replace(a,n)):(i.replaceWith(o),n.replaceWith(a))},250)}}),e(s).on("singletap",".move-down",function(t){var i=e(this).closest("li"),n=i.next(),a=i.clone(),o=n.clone();if(!(window.$chocolatechipjs&&i.is("li:last-child")[0]||window.jQuery&&i.is("li:last-child"))){e(s).data("list-edit",!0);var r=i[0].offsetHeight;i.css({"-webkit-transform":"translate3d(0,"+r+"px,0)",transform:"translate3d(0,"+r+"px,0)"}),n.css({"-webkit-transform":"translate3d(0,-"+r+"px,0)",transform:"translate3d(0,-"+r+"px,0)"}),setTimeout(function(){window.$chocolatechipjs?(e.replace(o,i),e.replace(a,n)):(i.replaceWith(o),n.replaceWith(a))},250)}}),e(s).on("singletap",".delete",function(){var t=this;e(s).data("list-edit",!0);var i="-1200%";"rtl"===e("html").attr("dir")&&(i="1000%"),e(this).siblings().css({"-webkit-transform":"translate3d("+i+",0,0)","-webkit-transition":"all 1s ease-out",transform:"translate3d("+i+",0,0)",transition:"all 1s ease-out"});var n=e(s).attr("data-list-items-deleted");void 0===n?n=[e(this).closest("li").attr("data-list-position")]:(n=n.split(","),n.push(e(this).closest("li").attr("data-list-position"))),e(s).attr("data-list-items-deleted",n.sort().join(",")),setTimeout(function(){e(t).parent().remove()},500)})})};return f(i.callback,e(this),o)}}}),e.fn.extend({UISelectList:function(t){var i={name:e.Uuid(),selected:0,callback:e.noop};t&&e.extend(i,t);var s=i.name,n=this[0];n.classList.add("select"),e(n).find("li").forEach(function(t,n){var a=null!==t.getAttribute("data-select-value")?t.getAttribute("data-select-value"):"";t.setAttribute("role","radio"),e(t).removeClass("selected").find("input").removeAttr("checked"),i.selected===n?(t.setAttribute("aria-checked","true"),t.classList.add("selected"),e(t).find("input")[0]?e(t).find("input").prop("checked",!0).attr("value",a):e(t).append('<input type="radio" checked="checked" name="'+s+'" value="'+a+'">')):e(t).find("input")[0]||e(t).append('<input type="radio" name="'+s+'" value="'+a+'">')}),e(n).on("singletap","li",function(){var t=this;e(t).siblings("li").removeClass("selected"),e(t).siblings("li").removeAttr("aria-checked"),e(t).siblings("li").find("input").removeAttr("checked"),e(t).addClass("selected"),t.setAttribute("aria-checked",!0),e(t).find("input").prop("checked",!0),i.callback.apply(this,arguments)})}}),e.extend({UISheet:function(t){var i={id:e.Uuid(),listClass:"",background:"",handle:!0};t&&e.extend(i,t),i.background&&(i.background=e.concat(' style="background-color:',i.background,'" ')),i.handle===!1&&(i.handle=""),i.handle='<div class="handle"><span></span></div>',t&&e.extend(i,t);var s=e.concat('<div id="',i.id,'" class="sheet',i.listClass,'"',i.background,">",i.handle,'<section class="scroller-vertical"></section></div>');e("body").append(s),e(".sheet .handle").on(e.eventStart,function(){var t=e(this);e.isAndroid||e.isChrome?(t.addClass("selected"),setTimeout(function(){t.removeClass("selected"),e.UIHideSheet()},500)):e.UIHideSheet()})},UIShowSheet:function(t){var i=t?t:".sheet";e("article.current").addClass("blurred"),e.isAndroid||e.isChrome?(e(i).css("display","block"),setTimeout(function(){e(i).addClass("opened")},20)):e(i).addClass("opened")},UIHideSheet:function(){e(".sheet").removeClass("opened"),e("article.current").addClass("removeBlurSlow"),setTimeout(function(){e("article").removeClass("blurred"),e("article").removeClass("removeBlurSlow")},500)}}),e.extend({UISlideout:function(t){var i={position:"left",dynamic:!1,callback:e.noop};t&&"object"==typeof t&&e.extend(i,t);var s=e("<button class='slide-out-button'></button>"),n='<div class="slide-out"><section></section></div>';e("article").removeClass("next"),e("article").removeClass("current"),e("article").prev().removeClass("next"),e("article").prev().removeClass("current"),e("body").append(n),e("body").addClass("slide-out-app"),e("article:first-of-type").addClass("show"),e("article:first-of-type").prev().addClass("show"),
e("#global-nav").append(s),e(".slide-out-button").on(e.eventStart,function(){e(".slide-out").toggleClass("open"),e(this).toggleClass("focused")}),i.dynamic?e(".slide-out").on("singletap","li",function(){var t=e(this);t.addClass("selected"),e(".slide-out").removeClass("open"),e(".slide-out-button").removeClass("focused"),setTimeout(function(){t.removeClass("selected")},500),e.isAndroid||e.isChrome?setTimeout(function(){i.callback(t),e(".slide-out-button").removeClass("focused")},400):(i.callback(t),e(".slide-out-button").removeClass("focused"))}):e(".slide-out").on("singletap","li",function(){var t=e(this);t.addClass("selected"),setTimeout(function(){t.removeClass("selected")},500);var i="#"+e(this).attr("data-show-article");e.UINavigationHistory[0]=i,e.UISetHashOnUrl(i),e.publish("chui/navigate/leave",e("article.show")[0].id),e.publish("chui/navigate/enter",i),e.isAndroid||e.isChrome?setTimeout(function(){e(".slide-out").removeClass("open"),e("article").removeClass("show"),e("article").prev().removeClass("show"),e(i).addClass("show"),e(i).prev().addClass("show"),e(".slide-out-button").removeClass("focused")},400):(e(".slide-out").removeClass("open"),e("article").removeClass("show"),e("article").prev().removeClass("show"),e(i).addClass("show"),e(i).prev().addClass("show"),e(".slide-out-button").removeClass("focused"))})}}),e.extend(e.UISlideout,{populate:function(t){var i=e(".slide-out");if(i[0]&&e.isArray(t)){i.find("section").append('<ul class="list"></ul>');var s=i.find("ul");t.forEach(function(e){for(var t in e)s.append("header"===t?'<li class="slideout-header"><h2>'+e[t]+"</h2></li>":'<li data-show-article="'+t+'"><h3>'+e[t]+"</h3></li>")})}}}),e.fn.extend({UIStepper:function(t){if(!t)return[];if(!t.start)return[];if(!t.end)return[];var i=e(this),s=t.start,n=t.end,a=t.defaultValue?t.defaultValue:t.start,o="+",r="-";e.isWin&&(o="",r="");var l='<button class="decrease"><span>'+r+"</span></button>",d="<label>"+a+'</label><input type="text" value="'+a+'">',c='<button class="increase"><span>'+o+"</span></button>";i.append(l+d+c),i.data("ui-value",{start:s,end:n,defaultValue:a});var u=function(){var t,s=i.find("input").val(),n=i.data("ui-value"),a=n.start;a>=s?e(this).addClass("disabled"):(t=Number(s)-1,i.find("button:last-of-type").removeClass("disabled"),i.find("label").text(t),i.find("input")[0].value=t,s===a&&e(this).addClass("disabled"))},h=function(){var t,s=i.find("input").val(),n=i.data("ui-value"),a=n.end;s>=a?e(this).addClass("disabled"):(t=Number(s)+1,i.find("button:first-of-type").removeClass("disabled"),i.find("label").text(t),i.find("input")[0].value=t,s===a&&e(this).addClass("disabled"))};i.find("button:first-of-type").on("singletap",function(){u.call(this,i)}),i.find("button:last-of-type").on("singletap",function(){h.call(this,i)})}}),e.extend({UIResetStepper:function(e){var t=e.data("ui-value").defaultValue;e.find("label").html(t),e.find("input")[0].value=t}}),e.fn.extend({UISwitch:function(){var t=!1,i="swiperight",s="swipeleft";"rtl"===document.documentElement.dir&&(i="swipeleft",s="swiperight"),this.forEach(function(n,a){n.setAttribute("role","checkbox"),e(n).data("ui-setup")!==!0&&(n.querySelector("input")||n.insertAdjacentHTML("afterBegin",'<input type="checkbox">'),n.classList.contains("on")&&n.querySelector("input").setAttribute("checked","checked"),n.querySelector("em")&&(t=!0),t||n.insertAdjacentHTML("afterBegin","<em></em>"),e(n).on("singletap",function(){var e=n.querySelector("input");n.classList.contains("on")?(n.classList.remove("on"),n.removeAttribute("aria-checked"),e.removeAttribute("checked")):(n.classList.add("on"),e.setAttribute("checked","checked"),n.setAttribute("aria-checked",!0))}),e(n).on(i,function(){var e=n.querySelector("input");n.classList.contains("on")&&(n.classList.remove("on"),n.removeAttribute("aria-checked"),e.removeAttribute("checked"))}),e(n).on(s,function(){var e=n.querySelector("input");n.classList.contains("on")||(n.classList.add("on"),e.setAttribute("checked","checked"),n.setAttribute("aria-checked",!0))}),e(n).data("ui-setup",!0))})}}),e.extend({UICreateSwitch:function(t){var i={id:e.Uuid(),name:"",value:"",state:"",checked:"",style:""};e.extend(i,t),"off"===i.state&&(i.state="");var s=e.concat('<span class="switch'," ",i.style," ",i.state,'" id="',i.id,'"><em></em>','<input type="checkbox"',i.name,i.checked,' value="',i.value,'"></span>');return e(s)}}),e(function(){e(".switch").UISwitch()}),document.addEventListener("touchstart",function(e){var t=e.target,i=0;for(i=0;10>i;i+=1)null!==t&&(void 0!==t.className&&t.className.match("navigable")&&(0===t.scrollTop?t.scrollTop=1:t.scrollTop+t.offsetHeight===t.scrollHeight&&(t.scrollTop=t.scrollTop-1)),t=t.parentNode)}),e.extend({UITabbar:function(t){if(t){var i={id:e.Uuid(),selected:0};e.extend(i,t),t.tabs&&t.labels||console.error("The tab bar needs labels and the number of tabs to function."),e("body").addClass("hasTabBar"),e.isiOS6&&e("body").addClass("isiOS6");for(var s='<div class="tabbar" id="'+i.id+'">',n=e.isiOS||e.isSafari?'<span class="icon"></span>':"",a=e("article"),o=0;o<i.tabs;o++)s+='<button class="'+i.icons[o],i.selected===o+1&&(s+=" selected"),s+='">'+n+"<label>"+i.labels[o]+"</label></button>";s+="</div>",e("body").append(s),e("#"+i.id).find("button").forEach(function(t,i){e(t).data("history",["#"+a.eq(i)[0].id])}),e("nav").removeClass("current").addClass("next"),e("#global-nav").removeClass("next"),e("nav").eq(i.selected).removeClass("next").addClass("current"),e("article").removeClass("current").addClass("next"),e("article").eq(i.selected-1).removeClass("next").addClass("current");var r="singletap";e.isAndroid&&(r=e.eventStart),e(".tabbar").on(r,"button",function(){var t,i,s=this;e.publish("chui/navigate/leave",e("article.current")[0].id),s.classList.add("selected"),e(s).siblings("button").removeClass("selected"),t=e(this).index(),e("article.previous").removeClass("previous").addClass("next"),e("nav.previous").removeClass("previous").addClass("next");var n=e(this).data("history");if(n.length>1){e("article.current").removeClass("current").addClass("next"),e("nav.current").removeClass("current").addClass("next"),e(n[n.length-1]).removeClass("next").addClass("current"),e(n[n.length-1]).prev().removeClass("next").addClass("current");for(var a=n.length-1,o=0;a>o;o++)e(n[o]).removeClass("next").addClass("previous"),e(n[o]).prev().removeClass("next").addClass("previous")}else e("article.current").removeClass("current").addClass("next"),e("nav.current").removeClass("current").addClass("next"),e("article").eq(t).removeClass("next").addClass("current"),e("nav").eq(t+1).removeClass("next").addClass("current");i=e("article").eq(t)[0].id,e.publish("chui/navigate/enter",i),e("article").forEach(function(t){window.jQuery?e(t).scrollTop(0):window.$chocolatechipjs&&(t.scrollTop=0)}),e.UISetHashOnUrl("#"+i),e.UINavigationHistory=e(this).data("history")})}}}),e.extend({templates:{},template:function(e,t){var i;t=t||"data",i=/\[\[=([\s\S]+?)\]\]/g;var s=new Function(t,"var p=[];p.push('"+e.replace(/[\r\t\n]/g," ").split("'").join("\\'").replace(i,"',$1,'").split("[[").join("');").split("]]").join("p.push('")+"');return p.join('');");return s}}),e.template.data={},e.template.index=0,e.template.repeater=function(t,i,s){if(t){if(!e.isArray(s))return console.error("$.template.repeater() requires data of type Array."),"$.template.repeater() requires data of type Array.";var n=e.template(i);e.isArray(s)&&s.forEach(function(i){e(t).append(n(i))})}else{var a=e("[data-repeater]");e.template.index=0,a.forEach(function(t){var i=t.innerHTML;t=e(t);var s=t.attr("data-repeater");if(!s||!e.template.data[s])return void console.error("No matching data for template. Check your data assignment on $.template.data or the template's data-repeater value.");t.empty(),t.removeClass("cloak");var n=e.template(i);e.template.data[s].forEach(function(i){t.append(n(i)),e.template.index+=1}),delete e.template.data[s]})}},e.extend({UISearch:function(t){var i=t&&t.articleId||e("article").eq(0),s=t&&t.id||e.Uuid(),n=t&&t.placeholder||"search",a=t&&t.results||1,o='<div class="searchBar"><input placeholder="'+n+'" type="search" results="'+a+'" id="'+s+'"></div>';e(i).find("section").prepend(o),e.isWin&&(e(i).prev().append(o),e("#"+s).parent().append('<span class="searchGlyph">&#xe11A;</span>'))}}),e(function(){var t=function(){function t(e){return""===s?e:(e=e.charAt(0).toUpperCase()+e.substr(1),s+e)}var i=document.createElement("div").style,s=function(){for(var e,t="t,webkitT".split(","),s=t.length,n=0;s>n;n++)if(e=t[n]+"ransform",e in i)return t[n].substr(0,t[n].length-1);return!1}(),n=s?"-"+s.toLowerCase()+"-":"",a=t("transform"),o=t("transitionDuration"),r="ontouchstart"in window;(window.navigator.pointerEnabled||window.navigator.msPointerEnabled)&&(r=!1);var l=e.eventStart,d=e.eventMove,c=e.eventEnd,u=e.eventCancel,h=function(){if(s===!1)return!1;var e={"":"transitionend",webkit:"webkitTransitionEnd"};return e[s]}(),p=function(t){var i={snapThreshold:null,loop:!0};if(t){e.extend(i,t);var s,a,o;this.carouselContainer="string"==typeof t.target?document.querySelector(t.target):t.target,this.options={panels:i.panels,snapThreshold:i.snapThreshold,loop:i.loop},e.isRTL&&(t.loop=!0);for(var r in t)this.options[r]=t[r];this.carouselContainer.style.overflow="hidden",this.carouselContainer.style.position="relative",this.carouselPanels=[],s=document.createElement("ul"),s.className="carousel-track",s.style.cssText="position:relative;top:0;height:100%;width:100%;"+n+"transition-duration:0;"+n+"transform:translateZ(0);"+n+"transition-timing-function:ease-out",this.carouselContainer.appendChild(s),this.track=s,this.refreshSize();for(var u,p=-1;2>p;p++)a=document.createElement("li"),a.id="carousel-panel-"+(p+1),a.style.cssText=n+"transform:translateZ(0);position:absolute;top:0;height:100%;width:100%;left:"+100*p+"%",u=-1===p?this.options.panels-1:p,e(a).data("upcomingPanelIndex",u),this.options.loop||-1!==p||(a.style.visibility="hidden"),this.track.appendChild(a),this.carouselPanels.push(a);o=this.carouselPanels[1].className,this.carouselPanels[1].className=o?o+" carousel-panel-active":"carousel-panel-active",this.carouselContainer.addEventListener(l,this,!1),this.carouselContainer.addEventListener(d,this,!1),this.carouselContainer.addEventListener(c,this,!1),this.track.addEventListener(h,this,!1);var v;if(t.pagination){v=document.createElement("ul"),v.className="pagination";for(var g=0;g<this.options.panels;g++)a=document.createElement("li"),0===g&&(a.className="selected"),v.appendChild(a);window.$chocolatechipjs?this.carouselContainer.insertAdjacentElement("afterEnd",v):e(this.carouselContainer).after(v)}}};return p.prototype={currentPanel:1,x:0,panel:0,customEvents:[],onSlide:function(e){this.carouselContainer.addEventListener("carousel-panel-move",e,!1),this.customEvents.push(["move",e])},destroy:function(){for(;this.customEvents.length;)this.carouselContainer.removeEventListener("carousel-panel-"+this.customEvents[0][0],this.customEvents[0][1],!1),this.customEvents.shift();this.carouselContainer.removeEventListener(l,this,!1),this.carouselContainer.removeEventListener(d,this,!1),this.carouselContainer.removeEventListener(c,this,!1),this.track.removeEventListener(h,this,!1)},refreshSize:function(){this.carouselContainerWidth=this.carouselContainer.clientWidth,this.carouselContainerHeight=this.carouselContainer.clientHeight,this.panelWidth=this.carouselContainerWidth,this.maxX=-this.options.panels*this.panelWidth+this.carouselContainerWidth,this.snapThreshold=null===this.options.snapThreshold?Math.round(.15*this.panelWidth):/%/.test(this.options.snapThreshold)?Math.round(this.panelWidth*this.options.snapThreshold.replace("%","")/100):this.options.snapThreshold},updatePanelCount:function(e){this.options.panels=e,this.maxX=-this.options.panels*this.panelWidth+this.carouselContainerWidth},goToPanel:function(t){this.carouselPanels[this.currentPanel].className=this.carouselPanels[this.currentPanel].className.replace(/(^|\s)carousel-panel-active(\s|$)/,""),t=0>t?0:t>this.options.panels-1?this.options.panels-1:t,console.log("p: ",t),this.panel=t,this.track.style[o]="0s",this.getPosition(-t*this.panelWidth),this.currentPanel=this.panel+1-3*Math.floor((this.panel+1)/3),this.carouselPanels[this.currentPanel].className=this.carouselPanels[this.currentPanel].className+" carousel-panel-active",0===this.currentPanel?(this.carouselPanels[2].style.left=100*this.panel-100+"%",this.carouselPanels[0].style.left=100*this.panel+"%",this.carouselPanels[1].style.left=100*this.panel+100+"%",e(this.carouselPanels[2]).data("upcomingPanelIndex",0===this.panel?this.options.panels-1:this.panel-1),e(this.carouselPanels[0]).data("upcomingPanelIndex",this.panel),e(this.carouselPanels[1]).data("upcomingPanelIndex",this.panel===this.options.panels-1?0:this.panel+1)):1===this.currentPanel?(this.carouselPanels[0].style.left=100*this.panel-100+"%",this.carouselPanels[1].style.left=100*this.panel+"%",this.carouselPanels[2].style.left=100*this.panel+100+"%",e(this.carouselPanels[0]).data("upcomingPanelIndex",0===this.panel?this.options.panels-1:this.panel-1),e(this.carouselPanels[1]).data("upcomingPanelIndex",this.panel),e(this.carouselPanels[2]).data("upcomingPanelIndex",this.panel===this.options.panels-1?0:this.panel+1)):(this.carouselPanels[1].style.left=100*this.panel-100+"%",this.carouselPanels[2].style.left=100*this.panel+"%",this.carouselPanels[0].style.left=100*this.panel+100+"%",e(this.carouselPanels[1]).data("upcomingPanelIndex",0===this.panel?this.options.panels-1:this.panel-1),e(this.carouselPanels[2]).data("upcomingPanelIndex",this.panel),e(this.carouselPanels[0]).data("upcomingPanelIndex",this.panel===this.options.panels-1?0:this.panel+1)),this.slide()},handleEvent:function(e){switch(e.type){case l:this.start(e);break;case d:this.move(e);break;case u:case c:this.end(e)}},getPosition:function(e){this.x=e,this.track.style[a]="translate("+e+"px,0) translateZ(0)"},resize:function(){this.refreshSize(),this.track.style[o]="0s",this.getPosition(-this.panel*this.panelWidth)},start:function(e){if(!this.initiated){var t=r?e.touches[0]:e;this.initiated=!0,this.moved=!1,this.thresholdExceeded=!1,this.startX=t.pageX,this.startY=t.pageY,this.pointX=t.pageX,this.pointY=t.pageY,this.stepsX=0,this.stepsY=0,this.directionX=0,this.directionLocked=!1,this.track.style[o]="0s",this.event("touchstart")}},move:function(e){if(this.initiated){var t=r?e.touches[0]:e,i=t.pageX-this.pointX,s=t.pageY-this.pointY,n=this.x+i;Math.abs(t.pageX-this.startX);if(this.moved=!0,this.pointX=t.pageX,this.pointY=t.pageY,this.directionX=i>0?1:0>i?-1:0,this.stepsX+=Math.abs(i),this.stepsY+=Math.abs(s),!(this.stepsX<10&&this.stepsY<10)){if(!this.directionLocked&&this.stepsY>this.stepsX)return void(this.initiated=!1);e.preventDefault(),this.directionLocked=!0,!this.options.loop&&(n>0||n<this.maxX)&&(n=this.x+i/2),this.getPosition(n)}}},end:function(e){if(this.initiated){var t=r?e.changedTouches[0]:e,i=Math.abs(t.pageX-this.startX);if(this.initiated=!1,this.moved)return!this.options.loop&&(this.x>0||this.x<this.maxX)&&(i=0),i<this.snapThreshold?(this.track.style[o]=Math.floor(300*i/this.snapThreshold)+"ms",void this.getPosition(-this.panel*this.panelWidth)):void this.checkPosition()}},checkPosition:function(){var t,i,s;this.carouselPanels[this.currentPanel].className="",this.directionX>0?(this.panel=-Math.ceil(this.x/this.panelWidth),this.currentPanel=this.panel+1-3*Math.floor((this.panel+1)/3),t=this.currentPanel-1,t=0>t?2:t,this.carouselPanels[t].style.left=100*this.panel-100+"%",i=this.panel-1):(this.panel=-Math.floor(this.x/this.panelWidth),this.currentPanel=this.panel+1-3*Math.floor((this.panel+1)/3),t=this.currentPanel+1,t=t>2?0:t,this.carouselPanels[t].style.left=100*this.panel+100+"%",i=this.panel+1),s=this.carouselPanels[this.currentPanel].className,/(^|\s)carousel-panel-active(\s|$)/.test(s)||(this.carouselPanels[this.currentPanel].className=s?s+" carousel-panel-active":"carousel-panel-active"),s=this.carouselPanels[t].className,i-=Math.floor(i/this.options.panels)*this.options.panels,e(this.carouselPanels[t]).data("upcomingPanelIndex",i);var n=-this.panel*this.panelWidth;this.track.style[o]=Math.floor(500*Math.abs(this.x-n)/this.panelWidth)+"ms",this.options.loop||(this.carouselPanels[t].style.visibility=0===n||n===this.maxX?"hidden":""),this.x===n?this.slide():(this.getPosition(n),this.slide())},slide:function(){this.event("move")},event:function(e){var t=document.createEvent("Event");t.initEvent("carousel-panel-"+e,!0,!0),this.carouselContainer.dispatchEvent(t)}},p}();e.extend({UISetupCarousel:function(i){function s(e){var t=e.shift(0);return e.reverse(),e.unshift(t),e}if(i){i.loop=i.loop||!1;var n=new t({target:i.target,panels:i.panels.length,loop:i.loop,pagination:i.pagination});e(i.target).data("carousel",n),e.isRTL&&(i.panels=s(i.panels));for(var a,o=0;3>o;o++)a=0===o?i.panels.length-1:o-1,n.carouselPanels[o].innerHTML=i.panels[Number(a)];var r=0,l=e(i.target).next("ul.pagination");n.onSlide(function(){for(var t=0;3>t;t++){var s=e(n.carouselPanels[t]).data("upcomingPanelIndex");n.carouselPanels[t].innerHTML=i.panels[Number(s)]}r=e(".carousel-panel-active").data("upcomingPanelIndex"),l.find("li").removeClass("selected"),e.isRTL?(l.find("li").removeClass("selected"),1>r?l.find("li").eq(0).addClass("selected"):l.find("li").eq(i.panels.length-r).addClass("selected")):l.find("li").eq(r).addClass("selected")}),e(i.target).on("mousedown","img",function(){return!1});var d=e(i.target).css("width");l.css("width",d),l.on("click","li",function(){e(this).siblings("li").removeClass("selected"),e(this).addClass("selected");var t=0;if(e.isRTL){var i=e(this).parent().children("li").length;0===e(this).index()?n.goToPanel(0):(t=i-e(this).index(),n.goToPanel(t)),e(this).siblings("li").removeClass("selected"),e(this).addClass("selected")}else n.goToPanel(0===e(this).index()?0:e(this).index())})}}})}),e.fn.extend({UIRange:function(){if(!e.isWin&&"INPUT"===this[0].nodeName){var t,i=e(this),s=i.width(),n=(i.val()-i.attr("min"))/(i.attr("max")-i.attr("min")),a=-1.3;0>n?t=0:n>1?t=s:(t=s*n+a,a-=n),i.css(e.isAndroid||e.isChrome?{"background-size":Math.round(t)+"px 3px, 100% 2px"}:{"background-size":Math.round(t)+"px 10px"})}}}),e(function(){e("input[type=range]").forEach(function(t){e(t).UIRange()}),e("body").on("input","input[type=range]",function(){e(this).UIRange()})}),e.extend({UISelectBox:function(){if(!e.isDesktop&&e.isiOS)e(".select-box-label").forEach(function(t){var i=e(t),s=i.prev();s[0].id||s.attr("id",e.Uuid()),s.trigger("singletap"),i.text(s.val()),i.attr("for",s.attr("id"))}),e(".select-box select").on("change",function(){e(this).next().text(e(this).val())});else if(!e.isDesktop){var t=function(e){var t;t=document.createEvent("MouseEvents"),t.initMouseEvent("mousedown",!0,!0,window),e.dispatchEvent(t)};e.isDesktop||(e(".select-box-label").forEach(function(t){t.id||e(t).prev().attr("id",e.Uuid());var i=e(t).siblings("select").val();e(t).text(i)}),e(".select-box select").on("change",function(){var t=e(this).find("option:selected").text(),i=e(this);i.next("label").text(e(this).val()),i.siblings("label").text(t)}),e("body").on("singletap",".select-box-label",function(){t(e("select")[0])}))}}}),e(function(){e.UISelectBox()}),e.extend(e,{UIBindData:function(t){var i;i=e(t?"[data-controller="+t+"]":"[data-controller]");var s=[],n=function(t){var i="data-binding-"+e(t).attr("data-controller");s.push(i)};i.forEach(function(t,i){var a=e(t).attr("data-controller");n(t),e.subscribe(s[i],function(t,i){var s="[data-model="+a+"]";e(s).text(i)})}),e("body").on("input change","[data-controller]",function(t){var i="data-binding-"+e(this).attr("data-controller");e.publish(i,e(this).val())})},UIUnBindData:function(t){delete e.subscriptions["data-binding-"+t]}})}(window.CHUIJSLIB);